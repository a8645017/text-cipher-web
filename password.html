<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>æ–‡å­—åŠ å¯†è½‰æ›å™¨ï¼ˆæ”¯æ´ä¸­æ–‡èˆ‡æ“´å±•è¦å‰‡ï¼‰</title>
<style>
  body {
    font-family: "Noto Sans TC", sans-serif;
    margin: 50px;
    background: #f9f9f9;
  }
  textarea, input {
    width: 100%;
    margin: 10px 0;
    font-size: 1.1rem;
  }
  button {
    padding: 10px 20px;
    margin-right: 10px;
    font-size: 1rem;
    cursor: pointer;
  }
</style>
</head>
<body>
<h2>ğŸ”’ ä¸­æ–‡æ–‡å­—åŠ å¯†è½‰æ›å™¨ï¼ˆ0â€“9å…¨è¦å‰‡ç‰ˆï¼‰</h2>
<p>è«‹è¼¸å…¥å››ä½æ•¸å¯†ç¢¼èˆ‡æ–‡å­—ï¼š</p>

<input type="password" id="key" placeholder="è¼¸å…¥å››ä½æ•¸å¯†ç¢¼ (ä¾‹å¦‚ 1234)" 
  autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
<textarea id="inputText" rows="4" placeholder="è¼¸å…¥è¦åŠ å¯†æˆ–è§£å¯†çš„æ–‡å­—..."></textarea>

<button onclick="encrypt()">åŠ å¯†</button>
<button onclick="decrypt()">è§£å¯†</button>

<h3>çµæœï¼š</h3>
<textarea id="outputText" rows="4" readonly></textarea>

<script>
/* ===== åŸºç¤è¦å‰‡è¨­å®š ===== */
function rule1(text) { return Array.from(text).map(ch => String.fromCharCode(ch.charCodeAt(0) + 1)).join(''); }
function rule1_reverse(text) { return Array.from(text).map(ch => String.fromCharCode(ch.charCodeAt(0) - 1)).join(''); }

function rule2(text) { return Array.from(text).reverse().join(''); }
function rule2_reverse(text) { return rule2(text); }

function rule3(text) { return Array.from(text).map(ch => String.fromCharCode(ch.charCodeAt(0) + 3)).join(''); }
function rule3_reverse(text) { return Array.from(text).map(ch => String.fromCharCode(ch.charCodeAt(0) - 3)).join(''); }

function rule4(text) { return Array.from(text).map(ch => String.fromCharCode(ch.charCodeAt(0) ^ 123)).join(''); }
function rule4_reverse(text) { return rule4(text); }

function rule5(text) { return Array.from(text).map(ch => String.fromCharCode(ch.charCodeAt(0) - 2)).join(''); }
function rule5_reverse(text) { return Array.from(text).map(ch => String.fromCharCode(ch.charCodeAt(0) + 2)).join(''); }

function rule6(text) {
  let arr = Array.from(text);
  for (let i = 0; i < arr.length - 1; i += 2) {
    [arr[i], arr[i + 1]] = [arr[i + 1], arr[i]];
  }
  return arr.join('');
}
function rule6_reverse(text) { return rule6(text); }

function rule7(text) { return Array.from(text).map(ch => String.fromCharCode(ch.charCodeAt(0) ^ 77)).join(''); }
function rule7_reverse(text) { return rule7(text); }

function rule8(text) { return btoa(unescape(encodeURIComponent(text))); }
function rule8_reverse(text) { return decodeURIComponent(escape(atob(text))); }

function rule9(text) {
  let evens = [], odds = [];
  Array.from(text).forEach((ch, i) => (i % 2 === 0 ? evens : odds).push(ch));
  return odds.join('') + evens.join('');
}
function rule9_reverse(text) {
  let half = Math.floor(text.length / 2);
  let odds = text.slice(0, half);
  let evens = text.slice(half);
  let result = '';
  for (let i = 0; i < text.length; i++) {
    result += i % 2 === 0 ? (evens[i / 2] || '') : (odds[(i - 1) / 2] || '');
  }
  return result;
}

function rule0(text) { return text.split('').map(ch => String.fromCharCode(ch.charCodeAt(0) + 5)).join(''); }
function rule0_reverse(text) { return text.split('').map(ch => String.fromCharCode(ch.charCodeAt(0) - 5)).join(''); }

const rules = {
  0: [rule0, rule0_reverse],
  1: [rule1, rule1_reverse],
  2: [rule2, rule2_reverse],
  3: [rule3, rule3_reverse],
  4: [rule4, rule4_reverse],
  5: [rule5, rule5_reverse],
  6: [rule6, rule6_reverse],
  7: [rule7, rule7_reverse],
  8: [rule8, rule8_reverse],
  9: [rule9, rule9_reverse]
};

/* ===== ä¸»ç¨‹å¼å€ ===== */
function encrypt() {
  let key = document.getElementById('key').value.trim();
  let text = document.getElementById('inputText').value;
  if (!/^\d{4}$/.test(key)) {
    alert("è«‹è¼¸å…¥å››ä½æ•¸å¯†ç¢¼ï¼ˆä¾‹å¦‚ 1234ï¼‰");
    return;
  }

  for (let d of key) {
    if (rules[d]) text = rules[d][0](text);
  }
  document.getElementById('outputText').value = text;
}

function decrypt() {
  let key = document.getElementById('key').value.trim();
  let text = document.getElementById('inputText').value;
  if (!/^\d{4}$/.test(key)) {
    alert("è«‹è¼¸å…¥å››ä½æ•¸å¯†ç¢¼ï¼ˆä¾‹å¦‚ 1234ï¼‰");
    return;
  }

  for (let d of key.split('').reverse()) {
    if (rules[d]) text = rules[d][1](text);
  }
  document.getElementById('outputText').value = text;
}
</script>
</body>
</html>
